@using Beanfamily.Models
@{
    BeanfamilyEntities models = new BeanfamilyEntities();
    List<string> giohangmuassam = Session["giohang-muasam"] as List<string>;
    List<string> giohangvuonrau = Session["giohang-vuonrau"] as List<string>;
    List<string> giohangthucdonhangngay = Session["giohang-thucdonhangngay"] as List<string>;

    TaiKhoanKhachHang tkkh = Session["user-data"] as TaiKhoanKhachHang;

    int SPMuaSam = (giohangmuassam != null ? giohangmuassam.Count : 0);
    int SPVuonRau = (giohangvuonrau != null ? giohangvuonrau.Count : 0);
    int SPMNHN = (giohangthucdonhangngay != null ? giohangthucdonhangngay.Count : 0);

    int sosanpham = SPMuaSam + SPVuonRau + SPMNHN;

    decimal tongMuaSam = 0;
    if (giohangmuassam != null)
    {
        foreach (var item in giohangmuassam)
        {
            int idLoai = Int32.Parse(item.Split('#')[1]);
            int soLuong = Int32.Parse(item.Split('#')[2]);

            tongMuaSam += models.TonKhoSanPhamMuaSam.Find(idLoai).gia * soLuong;
        }
    }

    decimal tongVuonRau = 0;
    if (giohangvuonrau != null)
    {
        foreach (var item in giohangvuonrau)
        {
            int idSP = Int32.Parse(item.Split('#')[0]);
            int soLuong = Int32.Parse(item.Split('#')[1]);

            tongVuonRau += models.SanPhamRauNhaTrong.Find(idSP).gia * soLuong;
        }
    }

    decimal tongMenuHangNgay = 0;
    if (giohangthucdonhangngay != null)
    {
        foreach (var item in giohangthucdonhangngay)
        {
            int idSP = Int32.Parse(item.Split('#')[0]);
            int soLuong = Int32.Parse(item.Split('#')[1]);

            tongMenuHangNgay += models.SanPhamThucDonHangNgay.Find(idSP).gia * soLuong;
        }
    }
    decimal tongTien = tongMuaSam + tongVuonRau + tongMenuHangNgay;
    string strTongTien = "";
    if (tongTien > 0)
    {
        strTongTien = tongTien.ToString("0,0") + "đ";
    }
    else
    {
        strTongTien = "0";
    }

    string diachi = "";
    string linkchiduong = "";

    var tt = models.ThongTinCauHinh.ToList();
    if (tt.Count > 0)
    {
        var tts = tt.First();
        diachi = tts.diachi;
        linkchiduong = tts.linkchiduong;
    }

    Layout = "~/Views/Shared/_LayoutMain.cshtml";
}

<!-- Title Page -->
<section style="background-repeat: no-repeat; background-position: center 0; background-size: cover; background-image: url(/Content/assets/images/backgroud.png);">
    <div class="flex-c-m" style="background-image: linear-gradient(180deg, #00000000 0%, #122E26 100%); width: 100%; min-height: 545px; padding-left: 15px; padding-right: 15px; background-repeat: no-repeat; background-position: center 0; background-size: cover; ">
        <div>
            <h2 class="tit6 t-center">
                TIẾN HÀNH ĐẶT HÀNG
            </h2>
            <h6 class="t-center text-white mt-2">
                <a class="text-white text-decoration-underline" href="@Url.Action("index", "home")">TRANG CHỦ</a>
                <label class="ms-2 me-2">/</label>
                <a class="text-white text-decoration-underline" href="@Url.Action("index", "dathang")">GIỎ HÀNG</a>
                <label class="ms-2 me-2">/</label>
                <a>TIẾN HÀNH ĐẶT HÀNG</a>
            </h6>
        </div>
    </div>
</section>

<section class="section-ourmenu bg1-pattern">
    <div class="section-child-bg1">
        <div class="container p-t-30 p-b-40">
            <div class="row">
                <div class="col-md-6 col-sm-12">
                    <div id="lastHeight" class="row p-r-30" style=" overflow-y:auto;">
                        <div class="col-lg-12 bgwhite" style="padding: 0; border-radius: 18px;">
                            @if ((giohangmuassam == null || giohangmuassam.Count < 1) && (giohangvuonrau == null || giohangvuonrau.Count < 1) && (giohangthucdonhangngay == null || giohangthucdonhangngay.Count < 1))
                            {
                                <div class="mb-3 bo-rad-16 text-white ms-3 me-3">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between row">
                                            <div style="width: 100%" class="d-flex flex-col align-items-center justify-content-center col-md-6 col-sm-6 ms-2 me-2 mt-2 mb-2">
                                                <h5 style="text-align: center; font-weight: bold; color: #333" class="mb-4 mt-4">Chưa có sản phẩm nào trong giỏ hàng!</h5>
                                                <a href="@Url.Action("index", "home")" style="width: auto; padding: 10px" class="btn3 flex-c-m size1 txt11 trans-0-4 mb-3">TIẾP TỤC MUA SẮM</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }
                            else
                            {
                                if ((giohangmuassam != null && giohangmuassam.Count > 0))
                                {
                                    <h5 class="text-center mb-3 text-white" style="background: #5e443b !important; border-radius: 16px 16px 0 0; height: 50px; display: flex; flex-direction: column; justify-content: center; ">SẢN PHẨM MỤC MUA SẮM</h5>

                                    foreach (var item in giohangmuassam)
                                    {
                                        int idPro = Int32.Parse(item.Split('#')[0]);
                                        int idLoaiPro = Int32.Parse(item.Split('#')[1]);
                                        int soluong = Int32.Parse(item.Split('#')[2]);

                                        var pro = models.SanPhamMuaSam.Find(idPro);
                                        if (pro == null)
                                        {
                                            continue;
                                        }
                                        else
                                        {
                                           
                                            <div class="card mb-3 bo-rad-16 bggreen text-white  ms-3 me-3">
                                                <div class="card-body" style="padding: 10px;">
                                                    <div class="d-flex justify-content-between row">
                                                        <div class="col-md-8 col-sm-8 ">
                                                            <div class="d-flex flex-row align-items-center ms-2 me-2 mt-2 mb-2">
                                                                <div>
                                                                    @if (string.IsNullOrEmpty(pro.hinhanh))
                                                                    {
                                                                        <a class="text-white" href="@Url.Action("productdetail", "muasam", new { id = idPro })">
                                                                            <img src="@Url.Content("~/Content/assets/images/product/sanphamdefault.jpg")"
                                                                                 class="img-fluid rounded-3" alt="Shopping item" style="width: 65px;">
                                                                        </a>
                                                                    }
                                                                    else
                                                                    {
                                                                        <a class="text-white" href="@Url.Action("productdetail", "muasam", new { id = idPro })">
                                                                            <img src="@Url.Content(pro.hinhanh.Split('#')[0])"
                                                                                 class="img-fluid rounded-3" alt="Shopping item" style="width: 65px;">
                                                                        </a>
                                                                    }
                                                                </div>
                                                                <div class="ms-3">
                                                                    <a class="text-white" href="@Url.Action("productdetail", "muasam", new { id = idPro })"><h6>@pro.tensanpham</h6></a>
                                                                    <p class="small mb-0">@(pro.TonKhoSanPhamMuaSam.FirstOrDefault(l => l.id == idLoaiPro) == null ? "Chọn phân loại hàng" : pro.TonKhoSanPhamMuaSam.FirstOrDefault(l => l.id == idLoaiPro).tenloai + ", " + pro.TonKhoSanPhamMuaSam.FirstOrDefault(l => l.id == idLoaiPro).gia.ToString("0,0") + "đ")</p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class=" col-md-4 col-sm-4">
                                                            <div class="d-flex flex-row align-items-center  float-end me-2">
                                                                <div class="row">
                                                                    <div class="ms-2 me-2 mt-2 col-sm-12 t-right">
                                                                        <a class="text-white">
                                                                            Số lượng: @soluong
                                                                        </a>
                                                                        <br />
                                                                        <a class="text-white mt-2">
                                                                            Tổng: @((pro.TonKhoSanPhamMuaSam.FirstOrDefault(l => l.id == idLoaiPro) == null ? "Chọn phân loại hàng" : (pro.TonKhoSanPhamMuaSam.FirstOrDefault(l => l.id == idLoaiPro).gia * soluong).ToString("0,0") + "đ"))
                                                                        </a>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        }
                                    }
                                }

                                if (giohangvuonrau != null && giohangvuonrau.Count > 0)
                                {
                                    if (giohangmuassam != null && giohangvuonrau != null)
                                    {
                                        if (giohangmuassam.Count > 0 && giohangvuonrau.Count > 0)
                                        {
                                            <h5 class="text-center mb-3 text-white" style="background: #5e443b !important; height: 50px; display: flex; flex-direction: column; justify-content: center;">SẢN PHẨM RAU NHÀ TRỒNG</h5>
                                        }
                                        else
                                        {
                                            <h5 class="text-center mb-3 text-white" style="background: #5e443b !important; border-radius: 16px 16px 0 0; height: 50px; display: flex; flex-direction: column; justify-content: center;">SẢN PHẨM RAU NHÀ TRỒNG</h5>
                                        }
                                    }
                                    else
                                    {
                                        <h5 class="text-center mb-3 text-white" style="background: #5e443b !important; border-radius: 16px 16px 0 0; height: 50px; display: flex; flex-direction: column; justify-content: center;">SẢN PHẨM RAU NHÀ TRỒNG</h5>
                                    }

                                    @*<h5 class="text-center mb-3 text-white" style="background: #5e443b !important; border-radius: 16px 16px 0 0; height: 50px; display: flex; flex-direction: column; justify-content: center;">SẢN PHẨM RAU NHÀ TRỒNG</h5>*@

                                    foreach (var item in giohangvuonrau)
                                    {
                                        int idPro = Int32.Parse(item.Split('#')[0]);
                                        int soluong = Int32.Parse(item.Split('#')[1]);

                                        var pro = models.SanPhamRauNhaTrong.Find(idPro);
                                        if (pro == null)
                                        {
                                            continue;
                                        }
                                        else
                                        {
                                            
                                            <div class="card mb-3 bo-rad-16 bggreen text-white ms-3 me-3">
                                                <div class="card-body" style="padding: 10px;">
                                                    <div class="d-flex justify-content-between row">
                                                        <div class="col-md-8 col-sm-8 ">
                                                            <div class="d-flex flex-row align-items-center ms-2 me-2 mt-2 mb-2">
                                                                <div>
                                                                    @if (string.IsNullOrEmpty(pro.hinhanh))
                                                                    {
                                                                        <a class="text-white" href="@Url.Action("productdetail", "vuonrau", new { id = idPro })">
                                                                            <img src="@Url.Content("~/Content/assets/images/product/sanphamdefault.jpg")"
                                                                                 class="img-fluid rounded-3" alt="Shopping item" style="width: 65px;">
                                                                        </a>
                                                                    }
                                                                    else
                                                                    {
                                                                        <a class="text-white" href="@Url.Action("productdetail", "vuonrau", new { id = idPro })">
                                                                            <img src="@Url.Content(pro.hinhanh.Split('#')[0])"
                                                                                 class="img-fluid rounded-3" alt="Shopping item" style="width: 65px;">
                                                                        </a>
                                                                    }
                                                                </div>
                                                                <div class="ms-3">
                                                                    <a class="text-white" href="@Url.Action("productdetail", "vuonrau", new { id = idPro })"><h6>@pro.tensanpham</h6></a>
                                                                    <p class="small mb-0">@pro.gia.ToString("0,0")đ / @pro.donvi</p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-4 col-sm-4 ">
                                                            <div class="d-flex flex-row align-items-center  float-end me-2">
                                                                <div class="row">
                                                                    <div class="ms-2 me-2 mt-2 col-sm-12 t-right">
                                                                        <a class="text-white">
                                                                            Số lượng: @soluong
                                                                        </a>
                                                                        <br />
                                                                        <a class="text-white mt-2">
                                                                            Tổng: @((pro.gia * soluong).ToString("0,0") + "đ")
                                                                        </a>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        }

                                    }
                                }

                                if (giohangthucdonhangngay != null && giohangthucdonhangngay.Count > 0)
                                {
                                    if (giohangvuonrau != null && giohangthucdonhangngay != null)
                                    {
                                        if (giohangvuonrau.Count > 0 && giohangthucdonhangngay.Count > 0)
                                        {
                                            <h5 class="text-center mb-3 text-white" style="background: #5e443b !important; height: 50px; display: flex; flex-direction: column; justify-content: center;">THỰC ĐƠN HẰNG NGÀY</h5>
                                        }
                                        else
                                        {
                                            <h5 class="text-center mb-3 text-white" style="background: #5e443b !important; border-radius: 16px 16px 0 0; height: 50px; display: flex; flex-direction: column; justify-content: center;">THỰC ĐƠN HẰNG NGÀY</h5>
                                        }
                                    }
                                    else
                                    {
                                        <h5 class="text-center mb-3 text-white" style="background: #5e443b !important; border-radius: 16px 16px 0 0; height: 50px; display: flex; flex-direction: column; justify-content: center;">THỰC ĐƠN HẰNG NGÀY</h5>
                                    }

                                    foreach (var item in giohangthucdonhangngay)
                                    {
                                        int idPro = Int32.Parse(item.Split('#')[0]);
                                        int soluong = Int32.Parse(item.Split('#')[1]);

                                        var pro = models.SanPhamThucDonHangNgay.Find(idPro);
                                        if (pro == null)
                                        {
                                            continue;
                                        }
                                        else
                                        {
                                            
                                            <div class="card mb-3 bo-rad-16 bggreen text-white ms-3 me-3">
                                                <div class="card-body" style="padding: 10px;">
                                                    <div class="d-flex justify-content-between row">
                                                        <div class="col-md-8 col-sm-8 ">
                                                            <div class="d-flex flex-row align-items-center ms-2 me-2 mt-2 mb-2">
                                                                <div>
                                                                    @if (string.IsNullOrEmpty(pro.hinhanh))
                                                                    {
                                                                        <a class="text-white" href="@Url.Action("productdetail", "thucdonhangngay", new { id = idPro })">
                                                                            <img src="@Url.Content("~/Content/assets/images/product/sanphamdefault.jpg")"
                                                                                 class="img-fluid rounded-3" alt="Shopping item" style="width: 65px;">
                                                                        </a>
                                                                    }
                                                                    else
                                                                    {
                                                                        <a class="text-white" href="@Url.Action("productdetail", "thucdonhangngay", new { id = idPro })">
                                                                            <img src="@Url.Content(pro.hinhanh.Split('#')[0])"
                                                                                 class="img-fluid rounded-3" alt="Shopping item" style="width: 65px;">
                                                                        </a>
                                                                    }
                                                                </div>
                                                                <div class="ms-3">
                                                                    <a class="text-white" href="@Url.Action("productdetail", "thucdonhangngay", new { id = idPro })"><h6>@pro.tensanpham</h6></a>
                                                                    <p class="small mb-0">@pro.gia.ToString("0,0")đ</p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-4 col-sm-4 ">
                                                            <div class="d-flex flex-row align-items-center  float-end me-2">
                                                                <div class="row">
                                                                    <div class="ms-2 me-2 mt-2 col-sm-12 t-right">

                                                                        <a class="text-white">
                                                                            Số lượng: @soluong
                                                                        </a>
                                                                        <br />
                                                                        <a class="text-white mt-2">
                                                                            Tổng: @((pro.gia * soluong).ToString("0,0") + "đ")
                                                                        </a>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        }

                                    }
                                }
                            }
                        </div>

                    </div>
                    <div id="truHeight" class="row p-r-30">
                        <div class="col-12 p-0 m-t-20">
                            <div class="bg-white bo-rad-16 txt10 p-t-20 p-b-20 p-l-20 p-r-20 m-b-10 m-t-3">
                                <div class="row">
                                    <div class="col-6 mb-1 text-dark">
                                        Tạm tính:
                                    </div>
                                    <div class="col-6 mb-1 float-end t-right text-dark">
                                        @strTongTien
                                    </div>

                                    <div class="col-6 text-dark">
                                        Phí vận chuyển:
                                    </div>
                                    <div class="col-6 float-end t-right text-dark">
                                        ---
                                    </div>
                                    <div class="col-12">
                                        <hr />
                                    </div>
                                    <div class="col-6 text-dark"><h6><b>Tổng:</b></h6></div>
                                    <div class="col-6 float-end t-right text-dark">
                                        <h6><b>@strTongTien</b></h6>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

                @if (tkkh == null)
                {
                    <div class="col-md-6 col-sm-12" style="border-left: 1px solid darkgray">
                        <div id="firstHeight" class="row">
                            <div class="col-12 p-l-30">
                                <div class="row mb-3" style="background: white; margin: 0px; border-radius: 18px">
                                    <div class="col-12" style="padding:0">
                                        <h5 class="text-center mb-3 text-white" style="background: #5e443b !important; border-radius: 16px 16px 0 0; height: 50px; display: flex; flex-direction: column; justify-content: center; ">THÔNG TIN ĐẶT HÀNG</h5>
                                    </div>
                                    <div class="col-12 p-l-20 p-r-20">
                                        <span class="txt9 text-dark">
                                            Họ và Tên <span class="text-danger">*</span>
                                        </span>

                                        <div class="wrap-inputname size12 bo-rad-16 m-t-3 mb-2">
                                            <input style="border: 1px solid #ced4da !important;" class="bo-rad-16 sizefull txt10 p-l-20" type="text" id="hoten" placeholder="Họ và Tên người nhận hàng">
                                        </div>
                                        <p hidden id="validate-tienhanhdathang-hoten" style="margin-top: -10px; margin-bottom: 10px" class="text-danger"></p>
                                    </div>
                                    <div class="col-md-6 col-sm-12 p-l-20">
                                        <span class="txt9 text-dark">
                                            Số điện thoại <span class="text-danger">*</span>
                                        </span>

                                        <div class="wrap-inputphone size12 bo-rad-16 m-t-3 mb-2">
                                            <input style="border: 1px solid #ced4da !important;" class="bo-rad-16 sizefull txt10 p-l-20" type="text" id="sodienthoai" name="phone" data-type="numbers" placeholder="Số điện thoại nhận hàng">
                                        </div>
                                        <p hidden id="validate-tienhanhdathang-sodienthoai" style="margin-top: -10px; margin-bottom: 10px" class="text-danger"></p>
                                    </div>
                                    <div class="col-md-6 col-sm-12 p-r-20">
                                        <span class="txt9 text-dark">
                                            Địa chỉ Email <span class="text-danger">*</span>
                                        </span>

                                        <div class="wrap-inputemail size12 bo-rad-16 m-t-3 mb-2">
                                            <input style="border: 1px solid #ced4da !important;" class="bo-rad-16 sizefull txt10 p-l-20" type="text" id="email" name="email" placeholder="Địa chỉ email">
                                        </div>
                                        <p hidden id="validate-tienhanhdathang-email" style="margin-top: -10px; margin-bottom: 10px" class="text-danger"></p>
                                    </div>

                                    <div class="col-12 p-l-20 p-r-20">
                                        <span class="txt9 text-dark">
                                            Ghi chú
                                        </span>
                                        <textarea style="width: 100%; border: 1px solid #ced4da !important; " class="bo-rad-16 txt10 p-l-20 p-t-15 mb-2 m-t-3" id="ghichu" rows="4" name="ghichu" placeholder="Ghi chú đơn hàng (nếu có)"></textarea>
                                        <p hidden id="validate-tienhanhdathang-ghichu" style="margin-top: -10px; margin-bottom: 10px" class="text-danger"></p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 p-l-30">
                                <span class="txt9">
                                    Địa chỉ nhận hàng <span class="text-danger">*</span>
                                </span>
                                <div class="bg-white bo-rad-16 txt10 p-l-20 p-r-20 p-t-20 p-b-20 mb-3 m-t-3">
                                    <div class="row">
                                        <div class="col-6">
                                            <div style="display: flex; flex-direction: row; align-items: center;" class="mb-0">
                                                <input checked id="giaotannoi" style=" height: 25px; width: 25px;" class="bo-rad-16 txt10 p-l-20 me-2 input-radio" type="radio" name="ptgh">
                                                <label for="giaotannoi" class="text-dark">Giao tận nơi</label><br>
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div style="display: flex; flex-direction: row; align-items: center;" class="mb-0">
                                                <input id="taicuahang" style=" height: 25px; width: 25px;" class="bo-rad-16 txt10 p-l-20 me-2 input-radio" type="radio" name="ptgh">
                                                <label for="taicuahang" class="text-dark">Đến cửa hàng</label><br>
                                            </div>
                                        </div>
                                    </div>
                                    <hr class="my-3" />
                                    <div id="chongiaotannoi" class="row">
                                        <div class="col-md-12">
                                            <div class="wrap-inputphone size12 bo-rad-16 m-t-3 mb-3">
                                                <input id="diachi" style="border: 1px solid #ced4da !important;" class="bo-rad-16 sizefull txt10 p-l-20" type="text" name="diachi" placeholder="Địa chỉ số nhà, tên đường">
                                            </div>
                                            <p hidden id="validate-tienhanhdathang-diachi" style="margin-top: -20px; margin-bottom: 10px" class="text-danger"></p>
                                        </div>
                                        <div class="col-md-12">
                                            <select style="border-radius: 16px; padding: 14px" class="form-select form-select-sm mb-3" id="city" aria-label=".form-select-sm">
                                                <option value="" selected>Chọn tỉnh thành</option>
                                            </select>
                                            <p hidden id="validate-tienhanhdathang-city" style="margin-top: -20px; margin-bottom: 10px" class="text-danger"></p>
                                        </div>
                                        <div class="col-md-12">
                                            <select style="border-radius: 16px; padding: 14px" class="form-select form-select-sm mb-3" id="district" aria-label=".form-select-sm">
                                                <option value="" selected>Chọn quận huyện</option>
                                            </select>
                                            <p hidden id="validate-tienhanhdathang-district" style="margin-top: -20px; margin-bottom: 10px" class="text-danger"></p>
                                        </div>
                                        <div class="col-md-12">
                                            <select style="border-radius: 16px; padding: 14px" class="form-select form-select-sm" id="ward" aria-label=".form-select-sm">
                                                <option value="" selected>Chọn phường xã</option>
                                            </select>
                                            <p hidden id="validate-tienhanhdathang-ward" style="margin-bottom: 10px" class="text-danger"></p>
                                        </div>
                                    </div>
                                    <div hidden id="chontaicuahang" class="row">
                                        <div class="col-md-12">
                                            <label style="font-weight: bold;" class="me-2">Địa chỉ chi nhánh:</label><span>@diachi.</span>
                                            <a href="@linkchiduong" target="_blank" style="width: auto; padding: 10px" class="btn3 flex-c-m size1 txt11 trans-0-4 mt-3">XEM TRÊN BẢN ĐỒ</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 p-l-30">
                                <span class="txt9">
                                    Phương thức thanh toán <span class="text-danger">*</span>
                                </span>
                                <div class="bg-white bo-rad-16 txt10 p-l-20 p-t-20 p-r-20 p-b-20 m-b-10 m-t-3">
                                    <div style="display: flex; flex-direction: row; align-items: center;" class="mb-3">
                                        <input checked id="ttknh" style=" height: 25px; width: 25px;" class="bo-rad-16 txt10 p-l-20 me-2 input-radio" type="radio" name="ptnh">
                                        <label for="ttknh" class="text-dark">Thanh toán khi nhận hàng</label><br>
                                    </div>
                                    <div style="display: flex; flex-direction: row; align-items: center;" class="mb-3">
                                        <input disabled id="ttmm" style=" height: 25px; width: 25px;" class="bo-rad-16 txt10 p-l-20 me-2 input-radio" type="radio" name="ptnh">
                                        <label for="ttmm" class="text-dark">Thanh toán qua MOMO <span class="text-danger fw-bold">(Bảo Trì)</span></label><br>
                                    </div>
                                    <div style="display: flex; flex-direction: row; align-items: center;">
                                        <input disabled id="ttnh" style=" height: 25px; width: 25px;" class="bo-rad-16 txt10 p-l-20 me-2 input-radio" type="radio" name="ptnh">
                                        <label for="ttnh" class="text-dark">Thanh toán qua Ngân hàng <span class="text-danger fw-bold">(Bảo Trì)</span></label><br>
                                    </div>
                                    <div style="width: 100%">
                                        <hr />
                                        <a id="xacNhanDatHang" style="width: auto; padding: 10px; cursor: pointer" class="btn3 flex-c-m size1 txt11 trans-0-4">XÁC NHẬN ĐẶT HÀNG</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                }
                else
                {
                    <div class="col-md-6 col-sm-12" style="border-left: 1px solid darkgray">
                        <div id="firstHeight" class="row">
                            <div class="col-12 p-l-30">
                                <div class="row mb-3" style="background: white; margin: 0px; border-radius: 18px">
                                    <div class="col-12" style="padding: 0">
                                        <h5 class="text-center mb-3 text-white" style="background: #5e443b !important; border-radius: 16px 16px 0 0; height: 50px; display: flex; flex-direction: column; justify-content: center; ">THÔNG TIN ĐẶT HÀNG</h5>
                                    </div>
                                    <div class="col-12 p-l-20 p-r-20">
                                        <span class="txt9 text-dark">
                                            Họ và Tên <span class="text-danger">*</span>
                                        </span>

                                        <div class="wrap-inputname size12 bo-rad-16 m-t-3 mb-2">
                                            <input style="border: 1px solid #ced4da !important;" value="@tkkh.hovaten" class="bo-rad-16 sizefull txt10 p-l-20" type="text" id="hoten" placeholder="Họ và Tên người nhận hàng">
                                        </div>
                                        <p hidden id="validate-tienhanhdathang-hoten" style="margin-top: -10px; margin-bottom: 10px" class="text-danger"></p>
                                    </div>
                                    <div class="col-md-6 col-sm-12 p-l-20">
                                        <span class="txt9 text-dark">
                                            Số điện thoại <span class="text-danger">*</span>
                                        </span>

                                        <div class="wrap-inputphone size12 bo-rad-16 m-t-3 mb-2">
                                            <input style="border: 1px solid #ced4da !important;" value="@tkkh.sodienthoai" class="bo-rad-16 sizefull txt10 p-l-20" type="text" id="sodienthoai" name="phone" data-type="numbers" placeholder="Số điện thoại nhận hàng">
                                        </div>
                                        <p hidden id="validate-tienhanhdathang-sodienthoai" style="margin-top: -10px; margin-bottom: 10px" class="text-danger"></p>
                                    </div>
                                    <div class="col-md-6 col-sm-12 p-r-20">
                                        <span class="txt9 text-dark">
                                            Địa chỉ Email <span class="text-danger">*</span>
                                        </span>

                                        <div class="wrap-inputemail size12 bo-rad-16 m-t-3 mb-2">
                                            <input style="border: 1px solid #ced4da !important;" value="@tkkh.email" class="bo-rad-16 sizefull txt10 p-l-20" type="text" id="email" name="email" placeholder="Địa chỉ email">
                                        </div>
                                        <p hidden id="validate-tienhanhdathang-email" style="margin-top: -10px; margin-bottom: 10px" class="text-danger"></p>
                                    </div>

                                    <div class="col-12 p-l-20 p-r-20 mb-2">
                                        <span class="txt9 text-dark">
                                            Ghi chú
                                        </span>
                                        <textarea style="width: 100%; border: 1px solid #ced4da !important;" class="bo-rad-16 txt10 p-l-20 p-t-15 mb-2 m-t-3" id="ghichu" rows="4" name="ghichu" placeholder="Ghi chú đơn hàng (nếu có)"></textarea>
                                        <p hidden id="validate-tienhanhdathang-ghichu" style="margin-top: -10px; margin-bottom: 10px" class="text-danger"></p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 p-l-30">
                                <span class="txt9">
                                    Địa chỉ nhận hàng <span class="text-danger">*</span>
                                </span>
                                <div class="bg-white bo-rad-16 txt10 p-l-20 p-r-20 p-t-20 p-b-20 mb-3 m-t-3">
                                    <div class="row">
                                        <div class="col-6">
                                            <div style="display: flex; flex-direction: row; align-items: center;" class="mb-0">
                                                <input checked id="giaotannoi" style=" height: 25px; width: 25px;" class="bo-rad-16 txt10 p-l-20 me-2 input-radio" type="radio" name="ptgh">
                                                <label for="giaotannoi" class="text-dark">Giao tận nơi</label><br>
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div style="display: flex; flex-direction: row; align-items: center;" class="mb-0">
                                                <input id="taicuahang" style=" height: 25px; width: 25px;" class="bo-rad-16 txt10 p-l-20 me-2 input-radio" type="radio" name="ptgh">
                                                <label for="taicuahang" class="text-dark">Đến cửa hàng</label><br>
                                            </div>
                                        </div>
                                    </div>
                                    <hr class="my-3" />
                                    <div id="chongiaotannoi" class="row">
                                        <div class="col-md-12">
                                            <div class="wrap-inputphone size12 bo-rad-16 m-t-3 mb-3">
                                                <input id="diachi" value="@tkkh.diachi" style="border: 1px solid #ced4da !important;" class="bo-rad-16 sizefull txt10 p-l-20" type="text" name="diachi" placeholder="Địa chỉ số nhà, tên đường">
                                            </div>
                                            <p hidden id="validate-tienhanhdathang-diachi" style="margin-top: -20px; margin-bottom: 10px" class="text-danger"></p>
                                        </div>
                                        <div class="col-md-12">
                                            <select style="border-radius: 16px; padding: 14px" class="form-select form-select-sm mb-3" id="city" aria-label=".form-select-sm">
                                                <option value="" selected>Chọn tỉnh thành</option>
                                            </select>
                                            <p hidden id="validate-tienhanhdathang-city" style="margin-top: -20px; margin-bottom: 10px" class="text-danger"></p>
                                        </div>
                                        <div class="col-md-12">
                                            <select style="border-radius: 16px; padding: 14px" class="form-select form-select-sm mb-3" id="district" aria-label=".form-select-sm">
                                                <option value="" selected>Chọn quận huyện</option>
                                            </select>
                                            <p hidden id="validate-tienhanhdathang-district" style="margin-top: -20px; margin-bottom: 10px" class="text-danger"></p>
                                        </div>
                                        <div class="col-md-12">
                                            <select style="border-radius: 16px; padding: 14px" class="form-select form-select-sm" id="ward" aria-label=".form-select-sm">
                                                <option value="" selected>Chọn phường xã</option>
                                            </select>
                                            <p hidden id="validate-tienhanhdathang-ward" style="margin-bottom: 10px" class="text-danger"></p>
                                        </div>
                                    </div>
                                    <div hidden id="chontaicuahang" class="row">
                                        <div class="col-md-12">
                                            <label style="font-weight: bold;" class="me-2">Địa chỉ chi nhánh:</label><span>@diachi.</span>
                                            <a href="@linkchiduong" target="_blank" style="width: auto; padding: 10px" class="btn3 flex-c-m size1 txt11 trans-0-4 mt-3">XEM TRÊN BẢN ĐỒ</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 p-l-30">
                                <span class="txt9">
                                    Phương thức thanh toán <span class="text-danger">*</span>
                                </span>
                                <div class="bg-white bo-rad-16 txt10 p-l-20 p-t-20 p-r-20 p-b-20 m-b-10 m-t-3">
                                    <div style="display: flex; flex-direction: row; align-items: center;" class="mb-3">
                                        <input checked id="ttknh" style=" height: 25px; width: 25px;" class="bo-rad-16 txt10 p-l-20 me-2 input-radio" type="radio" name="ptnh">
                                        <label for="ttknh" class="text-dark">Thanh toán khi nhận hàng</label><br>
                                    </div>
                                    <div style="display: flex; flex-direction: row; align-items: center;" class="mb-3">
                                        <input disabled id="ttmm" style=" height: 25px; width: 25px;" class="bo-rad-16 txt10 p-l-20 me-2 input-radio" type="radio" name="ptnh">
                                        <label for="ttmm" class="text-dark">Thanh toán qua MOMO <span class="text-danger fw-bold">(Bảo Trì)</span></label><br>
                                    </div>
                                    <div style="display: flex; flex-direction: row; align-items: center;">
                                        <input disabled id="ttnh" style=" height: 25px; width: 25px;" class="bo-rad-16 txt10 p-l-20 me-2 input-radio" type="radio" name="ptnh">
                                        <label for="ttnh" class="text-dark">Thanh toán qua Ngân hàng <span class="text-danger fw-bold">(Bảo Trì)</span></label><br>
                                    </div>
                                    <div style="width: 100%">
                                        <hr />
                                        <a id="xacNhanDatHang" style="width: auto; padding: 10px; cursor: pointer" class="btn3 flex-c-m size1 txt11 trans-0-4">XÁC NHẬN ĐẶT HÀNG</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>

    </div>
</section>

<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"></script>
<script>
    var firstHeight = $('body').find('[id="firstHeight"]').height();
    var lastHeight = $('body').find('[id="lastHeight"]').height();
    var truHeight = $('body').find('[id="truHeight"]').height();
    var MinHeight = firstHeight - truHeight;

    if (lastHeight > MinHeight) {
        $('body').find('[id="lastHeight"]').height(MinHeight);
    }

    var citis = document.getElementById("city");
    var districts = document.getElementById("district");
    var wards = document.getElementById("ward");

    var Parameter = {
        url: "https://raw.githubusercontent.com/kenzouno1/DiaGioiHanhChinhVN/master/data.json",
        method: "GET",
        responseType: "application/json",
    };
    var promise = axios(Parameter);
    promise.then(function (result) {
        renderCity(result.data);
    });

    function renderCity(data) {
        for (const x of data) {
            citis.options[citis.options.length] = new Option(x.Name, x.Id);
        }
        citis.onchange = function () {
            district.length = 1;
            ward.length = 1;
            if (this.value != "") {
                const result = data.filter(n => n.Id === this.value);

                for (const k of result[0].Districts) {
                    district.options[district.options.length] = new Option(k.Name, k.Id);
                }
            }
        };
        district.onchange = function () {
            ward.length = 1;
            const dataCity = data.filter((n) => n.Id === citis.value);
            if (this.value != "") {
                const dataWards = dataCity[0].Districts.filter(n => n.Id === this.value)[0].Wards;

                for (const w of dataWards) {
                    wards.options[wards.options.length] = new Option(w.Name, w.Id);
                }
            }
        };
    }
</script>
<script src="~/ActionOnPage/GioHang/DatHang.js"></script>